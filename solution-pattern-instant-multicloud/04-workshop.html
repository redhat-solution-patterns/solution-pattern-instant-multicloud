<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Solution Pattern: Instant Multi Cloud :: Solution Patterns for Cloud Native Architectures</title>
    <link rel="canonical" href="https://redhat-solution-patterns.github.io/solution-patterns/solution-pattern-instant-multicloud/04-workshop.html">
    <link rel="prev" href="03-demo.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z59MECL61B"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Z59MECL61B');
</script>  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://redhat.com" target="_blank"><img
          src="../_/img/logo.png" height="40px" alt="Cloud Native Architecture Solution Patterns"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://redhat-solution-patterns.github.io/solution-patterns">Solution Patterns for Cloud Native Architectures</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

       
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Solution Patterns</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Adopt Change Data Capture for <br/>stack modernization</a>
            <a class="navbar-item" href="#">Edge-to-Cloud Pipelines</a>     <a class="navbar-item" href="#">Event driven architecture</a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Other</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-gitops-patterns.io/">GitOps Solution Patterns</a>
            <a class="navbar-item" href="https://hybrid-cloud-patterns.io/">Hybrid Cloud Solution Patterns</a>
          </div>
        </div>

        <a class="navbar-item" target="_blank" href="https://www.redhat.com/en/products/middleware">Red Hat Application Services</a>

        <a class="navbar-item" target="_blank" href="https://developers.redhat.com/middleware">Learn more</a>

      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="solution-pattern-instant-multicloud" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">Instant Multi Cloud - Openshift Everywhere</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">1. Home page</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#multi-cloud">1.1 Usecases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#story">1.2 The story behind the pattern</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="index.html#solution">1.3 The solution</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-architecture.html">2. Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#in_depth">2.1. An in-depth look at the solution&#8217;s architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-architecture.html#_more_about_the_technology_stack">2.2. More about the technology stack</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-demo.html">3. See the Solution in Action</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-demo.html#_demonstration">3.1. Demonstration</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-workshop.html">4. Workshop</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_installing_the_workshop_environment">4.1. Installing the workshop environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_delivering_the_workshop">4.2. Delivering the workshop</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="https://redhat-solution-patterns.github.io/solution-patterns/patterns.html" target="_blank" rel="noopener">5. Other Red Hat Solution Patterns</a></span>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Instant Multi Cloud - Openshift Everywhere</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Instant Multi Cloud - Openshift Everywhere</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Instant Multi Cloud - Openshift Everywhere</a></li>
    <li><a href="04-workshop.html">4. Workshop</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-solution-patterns/solution-pattern-instant-multicloud/edit/main/documentation/modules/ROOT/pages/04-workshop.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Solution Pattern: Instant Multi Cloud</h1>
<h1 id="_workshop" class="sect0"><a class="anchor" href="#_workshop"></a><a class="link" href="#_workshop">Workshop</a></h1>
<div class="openblock partintro">
<div class="content">
In the workshop, we will be deploying an application OsToy to managed OpenShift clusters running in AWS, Azure and GCP.
</div>
</div>
<div class="sect1">
<h2 id="_installing_the_workshop_environment"><a class="anchor" href="#_installing_the_workshop_environment"></a><a class="link" href="#_installing_the_workshop_environment">1. Installing the workshop environment</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>These managed OpenShift clusters are required for the workshop:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Two Red Hat Openshift Service on AWS (ROSA) clusters(one for dev and second for prod)</p>
</li>
<li>
<p>One Azure Red Hat Openshift (ARO) cluster</p>
</li>
<li>
<p>One Openshift Dedicated on GCP cluster</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once clusters are ready, you can move to "Delivering the workshop" part.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are a Red Hatter, you can follow the below steps to get these above clusters created.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Login to <a href="https://demo.redhat.com/catalog" target="_blank" rel="noopener">Red Hat Demo Platform</a> and create the managed OpenShift clusters:</p>
<div class="ulist">
<ul>
<li>
<p>Two Red Hat Openshift Service on AWS (ROSA) clusters(one for dev and second for prod) using this link <a href="https://demo.redhat.com/catalog?search=aws&amp;item=babylon-catalog-prod%2Fsandboxes-gpte.rosa.prod" target="_blank" rel="noopener">ROSA</a></p>
</li>
<li>
<p>Azure Red Hat Openshift (ARO) using this link <a href="https://demo.redhat.com/catalog?search=aro&amp;item=babylon-catalog-prod%2Fazure-gpte.open-environment-azure-aro4.prod" target="_blank" rel="noopener">ARO</a></p>
</li>
<li>
<p>Openshift Dedicated on GCP by following this <a href="https://youtu.be/AI4WwSZJi9g" target="_blank" rel="noopener">video</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_delivering_the_workshop"><a class="anchor" href="#_delivering_the_workshop"></a><a class="link" href="#_delivering_the_workshop">2. Delivering the workshop</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Fork this repo using workshop branch: <a href="https://github.com/gmidha1/ostoy/tree/workshop" target="_blank" rel="noopener">Repository link</a></p>
</li>
<li>
<p>Once forked, go to your repo in Github UI and go to Settings → Security → Secrets and Variables → Actions.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="wkshp_secrets.png" target="_blank" rel="noopener"><img src="_images/wkshp_secrets.png" alt="wkshp secrets" width="100%"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Under Secrets, click on the “New repository secret” button to create a secret. We will be creating the following secrets which will be used by our workflow to access and deploy our applications:</p>
<div class="ulist">
<ul>
<li>
<p>ROSA_SERVER: API server url for ROSA cluster.</p>
</li>
<li>
<p>ROSA_TOKEN: Token for ROSA cluster.</p>
</li>
<li>
<p>ARO_SERVER: API server url for ARO cluster.</p>
</li>
<li>
<p>ARO_TOKEN: Token for ARO cluster.</p>
</li>
<li>
<p>GCP_SERVER: API server url for GCP cluster.</p>
</li>
<li>
<p>GCP_TOKEN: Token for GCP cluster.</p>
</li>
<li>
<p>ROSA_SERVER_PROD: API server url for ROSA PROD cluster.</p>
</li>
<li>
<p>ROSA_TOKEN: Token for ROSA PROD cluster.</p>
</li>
<li>
<p>QUAY_TOKEN: Token for pushing and pulling container images to Quay container registry.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="wkshp_secrets2.png" target="_blank" rel="noopener"><img src="_images/wkshp_secrets2.png" alt="wkshp secrets2" width="100%"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to Settings → Security → Secrets and Variables → Actions → Variables tab. We will be creating variables that will control the flow of the workflow:</p>
<div class="ulist">
<ul>
<li>
<p>ARO_LIVE: if set to true, it will deploy the application to the ARO cluster.</p>
</li>
<li>
<p>GCP_LIVE: if set to true, it will deploy the application to the GCP cluster.</p>
</li>
<li>
<p>ROSA_LIVE: if set to true, it will deploy the application to the ROSA DEV cluster.</p>
</li>
<li>
<p>ROSA_PROD: if set to true, it will deploy the application to the ROSA PROD cluster.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="wkshp_vars.png" target="_blank" rel="noopener"><img src="_images/wkshp_vars.png" alt="wkshp vars" width="100%"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Now let us go through the contents of the workflow file: .github/workflows/openshift.yml. Workflow is divided into the following stages:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Build and Push to Quay: This stage will build the container image from source code and push to container registry Quay.</p>
</li>
<li>
<p>ROSA deployment Dev: This stage deploys the application to the Dev ROSA environment/cluster.</p>
</li>
<li>
<p>ROSA deployment PROD: This stage deploys the application to PROD ROSA environment/cluster.</p>
</li>
<li>
<p>ARO deployment: This stage deploys the application to the ARO environment/cluster.</p>
</li>
<li>
<p>GCP deployment: This stage deploys the application to the OSD GCP Openshift cluster.</p>
</li>
</ol>
</div>
</li>
<li>
<p>As our workflow is ready, we can go to the Actions tab in GitHub UI and start the workflow using the workshop branch.</p>
</li>
<li>
<p>Once completed, the workflow UI will show the completed stages in green as shown below. We can expand the steps in the stage and check the logs for it.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="wkshp_run1.png" target="_blank" rel="noopener"><img src="_images/wkshp_run1.png" alt="wkshp run1" width="100%"></a>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="wkshp_run2.png" target="_blank" rel="noopener"><img src="_images/wkshp_run2.png" alt="wkshp run2" width="100%"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Now we can browse the application by using the respective cloud’s Openshift console → Networking → Route → search for ostoy and open the ostoy route url.</p>
<div class="ulist">
<ul>
<li>
<p>ARO console UI:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="wkshp_aro_console.png" target="_blank" rel="noopener"><img src="_images/wkshp_aro_console.png" alt="wkshp aro console" width="100%"></a>
</div>
</div>
</li>
<li>
<p>ARO - Ostoy application UI:</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="wkshp_aro_ostoy.png" target="_blank" rel="noopener"><img src="_images/wkshp_aro_ostoy.png" alt="wkshp aro ostoy" width="100%"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Similarly we will access the OSToy application from Openshift clusters running in GCP and AWS.</p>
<div class="ulist">
<ul>
<li>
<p>GCP - OStoy application UI:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="wkshp_gcp_ostoy.png" target="_blank" rel="noopener"><img src="_images/wkshp_gcp_ostoy.png" alt="wkshp gcp ostoy" width="100%"></a>
</div>
</div>
</li>
<li>
<p>ROSA - OStoy application UI:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="wkshp_rosa_ostoy.png" target="_blank" rel="noopener"><img src="_images/wkshp_rosa_ostoy.png" alt="wkshp rosa ostoy" width="100%"></a>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>We can use third party Load Balancer Service such as Cloudflare to route the traffic to the application running in one of the clouds. For the end user, it will be seamless access.</p>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="03-demo.html" class="query-params-link">3. See the Solution in Action</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <img
          src="../_/img/app-services-logo.png" height="40px" alt="Cloud Native Architecture Solution Patterns"  href="https://redhat.com" ></a>
</footer><script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
